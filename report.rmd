---
title: " "
author:
- familyname: YANG
  othernames: Mengyuan
  address: Monash University
  email: "myan0065@student.monash.edu"
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: BATSAIKHAN
  othernames: Zoljargal
  address: Monash University
  email: "zbat0001@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: WANG
  othernames: Xinrui
  address: Monash University
  email: "xwan0274@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: GOH
  othernames: Xueqi
  address: MONASH UNIVERSITY
  email: "xgoh0002@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
department: Our consultancy \newline Mengyuan YANG &\newline Zoljargal BATSAIKHAN &\newline Xinrui WANG &\newline Xueqi GOH
organization: Monash University
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(gridExtra)
library(tinytex)
library(readxl)
library(naniar)
```


\section*{Introduction}

```{r}
excel_sheets("data/API_4_DS2_en_excel_v2_2252569.xls")

data_income <- read_excel("data/CLASS.xls", range = anchored("C5", dim = c(220,5))) %>% 
  select(-X) %>% 
  filter(Economy != "x")
```

```{r}
df<- read_excel("Data/API_4_DS2_en_excel_v2_2252569.xls", sheet = 1, range = "A4:BM42772") %>% 
  select("Country Name", 
         "Country Code",
         "Indicator Name", 
         "2000":"2019") %>% 
  rename("country_name" = "Country Name",
         "indicator" = "Indicator Name",
         "country_code" = "Country Code")
```


```{r}
df %>%
  group_by(country_name) %>%
  miss_var_summary() %>% 
  arrange(-pct_miss)
```

```{r}
df_filter <- df %>% 
  filter(!(country_name %in% c("Faroe Islands",
                          "Greenland",
                          "Isle of Man",
                          "Not classified",
                          "St. Martin (French part)",
                          "Northern Mariana Islands",
                          "Kosovo",
                          "American Samoa",
                          "Gibraltar",
                          "Sint Maarten (Dutch part)",
                          "Turks and Caicos Islands",
                          "Channel Islands",
                          "Guam",
                          "French Polynesia",
                          "Curacao",
                          "New Caledonia",
                          "Virgin Islands (U.S.)",
                          "Nauru",
                          "Palau",
                          "Somalia",
                          "Guinea-Bissau")))
       
```

```{r}
data_joined <- df_filter %>% 
    left_join(data_income, by = c("country_name" = "Economy",
                                "country_code" = "Code")) 
```

\section*{Mengyun}


\section*{Zoljargal}

In this section we will discuss education expenditure across different countries in time period of 2000 to 2019. The indicator we have chosen to analyze in this section is:
 -  Government expenditure on education, total (% of GDP). General government expenditure on education (current, capital, and transfers) is expressed as a percentage of GDP. It includes expenditure funded by transfers from international sources to government. 

```{r}
data_gdp <- read_excel("data/GDPpercapita.xls", range = anchored("A4", dim = c(265,64))) %>% 
  select("Country Name", 
         "Country Code", 
         "2000":"2019") %>% 
  rename("country_name" = "Country Name",
         "country_code" = "Country Code") %>% 
  pivot_longer(cols = "2000":"2019",
               names_to = "year",
               values_to = "GDPpercapita")

data_zb <- data_joined %>% 
  pivot_longer(cols = c("2000":"2019"),
               names_to = "year",
               values_to = "value") %>% 
  filter(indicator %in% c("Government expenditure on education, total (% of GDP)",
                          "Government expenditure on education, total (% of government expenditure)",
                          "Expenditure on secondary education (% of government expenditure on education)",
                          "Government expenditure per student, secondary (% of GDP per capita)",
                          "Expenditure on primary education (% of government expenditure on education)",
                          "Government expenditure per student, primary (% of GDP per capita)")) %>% 
  pivot_wider(names_from = indicator,
              values_from = value) %>% 
  drop_na(Region) %>% 
  rename("income_group" = "Income group",
         "region" = "Region")

selected_indicators = c("Government expenditure on education, total (% of GDP)",
                          "Government expenditure on education, total (% of government expenditure)",
                          "Expenditure on secondary education (% of government expenditure on education)",
                          "Government expenditure per student, secondary (% of GDP per capita)",
                          "Expenditure on primary education (% of government expenditure on education)",
                          "Government expenditure per student, primary (% of GDP per capita)")

new_name = c("ex_total_GDP",
             "ex_total_gov_ex",
             "ex_secondary",
             "ex_per_student_secondary",
             "ex_primary",
             "ex_per_student_primary")

for(i in 1:6) names(data_zb)[names(data_zb) == selected_indicators[i]] = new_name[i]

data_zb$country_name[which(data_zb$country_name == "United States")] = "USA"
data_zb$country_name[which(data_zb$country_name == "United Kingdom")] = "UK"
data_zb$country_name[which(data_zb$country_name == "Russian Federation")] = "Russia"
data_zb$country_name[which(data_zb$country_name == "Iran, Islamic Rep.")] = "Iran"
data_zb$country_name[which(data_zb$country_name == "Congo, Rep.")] = "Democratic Republic of the Congo"
data_zb$country_name[which(data_zb$country_name == "Venezuela, RB")] = "Venezuela"
data_zb$country_name[which(data_zb$country_name == "Yemen, Rep.")] = "Yemen"
data_zb$country_name[which(data_zb$country_name == "Egypt, Arab Rep.")] = "Egypt"

data_zb <- data_zb %>% 
  left_join(data_gdp, by = c("country_name", "country_code", "year"))
```

```{r plot1-zb, fig.cap = "Government expenditure on education (% of GDP), 2000-2019"}
data1_zb <- data_zb %>% 
  group_by(country_name) %>% 
  summarise(mean = mean(ex_total_GDP, na.rm = TRUE))

world_map <- map_data("world")

data1_zb_wm <- world_map %>% 
  left_join(data1_zb, by = c("region" = "country_name"))

data1_zb_wm %>% 
  ggplot(aes(long, lat, group = group))+
  geom_polygon(aes(fill = mean), color = "white")+
  scale_fill_viridis_c(option = "C") +
  ggtitle("World map", subtitle = "Average government expenditure on education (% of GDP), 2000-2019")

```
Figure \@ref(fig:plot1-zb), provides an overview of spending on education by country. To produce the figure, we calculated average spending over the time period for each country. The average government spending on education across countries ranged between 1.2% - 11.5% of their GDP.

```{r plot2-zb, fig.cap = "Government expenditure on education (% of GDP), by income group"}
data2_zb <- data_zb %>% 
  filter(year != "2019") %>% 
  group_by(income_group, year) %>% 
  summarise(mean = mean(ex_total_GDP, na.rm = TRUE))

ggplot(data2_zb, aes(x=year, y=mean, group = income_group)) + 
    geom_line(aes(color = income_group)) +
  geom_point(aes(color = income_group))
```

Then we looked at the government expenditure on education by income group over time in Figure \@ref(fig:plot2-zb). What evident on the graph is that the low income countries are devoted much lesser proportion of their GDP but also we can see that spending has increased on average for those countries. On the other hand, high income countries spending more share of their GDP roughly between 4.5% to 5%. However the data had many missing values, a broad upward trend can be observed from the Figure \@ref(fig:plot2-zb).

```{r plot3-zb, fig.cap = "Government expenditure on education (% of GDP), by region"}
data3_zb <- data_zb %>% 
  filter(year != "2019",
         region != "North America") %>% 
  group_by(region, year) %>% 
  summarise(mean = mean(ex_total_GDP, na.rm = TRUE)) 

data3_zb %>% 
  ggplot(aes(x=year, y=mean, group = region)) + 
    geom_line(aes(color = region)) +
  geom_point(aes(color = region))

```

Cross-country spending patters

When did the provision of education first become a public policy priority?

Governments around the world are nowadays widely perceived to be responsible for ensuring the provision of accessible quality education. The advancement of the idea to provide education for more and more children only began in the mid 19th century, when most of today’s industrialized countries started expanding primary education.

The visualization, plotting public expenditure on education as a share of Gross Domestic Product (GDP) for a number of early-industrialized countries, shows that this expansion took place mainly through public funding.12
The last two decades have seen a small but general increase in the share of income that countries devote to education. The chart plots trends in public expenditure on education as a share of GDP. As usual, a selection of countries is shown by default, but other countries can be added by clicking on the relevant option at the top of the chart. Although the data is highly irregular due to missing observations for many countries, we can still observe a broad upward trend for the majority of countries. Specifically, it can be checked that of the 88 countries with available data for 2000/2010, three-fourths increased education spending as a share of GDP within this decade. As incomes – measured by GDP per capita – are generally increasing around the world, this means that the total amount of global resources spent on education is also increasing in absolute terms.

```{r plot4-zb, fig.cap = "Government expenditure on education (% of GDP), by income group, in 2000 and 2015"}
data_zb %>% 
  filter(year != "2019") %>% 
  group_by(income_group, year) %>% 
  summarise(mean = mean(ex_total_GDP, na.rm = TRUE)) %>% 
  pivot_wider(names_from = year,
              values_from = mean) %>% 
  select(income_group, "2000", "2015") %>% 
  mutate(change = (`2015` - `2000`)/`2000`*100) %>% 
  kable(col.names = c("Income groups", 
                      "2000",
                      "2015",
                      "Percentage change"),
        align = "c",
        caption = "Total government expenditure on educationby income group in 2000 and 2015",
        digits = 2) %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))

```


```{r}

```

\section*{Xinrui}


\section*{Xueqi}


\section*{Conclusion}


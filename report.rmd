---
title: " "
author:
- familyname: YANG
  othernames: Mengyuan
  address: Monash University
  email: "myan0065@student.monash.edu"
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: BATSAIKHAN
  othernames: Zoljargal
  address: Monash University
  email: "zbat0001@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: WANG
  othernames: Xinrui
  address: Monash University
  email: "xwan0274@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: GOH
  othernames: Xueqi
  address: MONASH UNIVERSITY
  email: "xgoh0002@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
department: Our consultancy \newline Mengyuan YANG &\newline Zoljargal BATSAIKHAN &\newline Xinrui WANG &\newline Xueqi GOH
organization: Monash University
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(gridExtra)
library(tinytex)
library(readxl)
library(naniar)
```


\section*{Introduction}

```{r}
excel_sheets("data/API_4_DS2_en_excel_v2_2252569.xls")

data_income <- read_excel("data/CLASS.xls", range = anchored("C5", dim = c(220,5))) %>% 
  select(-X) %>% 
  filter(Economy != "x")
```

```{r}
df<- read_excel("Data/API_4_DS2_en_excel_v2_2252569.xls", sheet = 1, range = "A4:BM42772") %>% 
  select("Country Name", 
         "Country Code",
         "Indicator Name", 
         "2000":"2019") %>% 
  rename("country_name" = "Country Name",
         "indicator" = "Indicator Name",
         "country_code" = "Country Code")
```


```{r}
df %>%
  group_by(country_name) %>%
  miss_var_summary() %>% 
  arrange(-pct_miss)
```

```{r}
df_filter <- df %>% 
  filter(!(country_name %in% c("Faroe Islands",
                          "Greenland",
                          "Isle of Man",
                          "Not classified",
                          "St. Martin (French part)",
                          "Northern Mariana Islands",
                          "Kosovo",
                          "American Samoa",
                          "Gibraltar",
                          "Sint Maarten (Dutch part)",
                          "Turks and Caicos Islands",
                          "Channel Islands",
                          "Guam",
                          "French Polynesia",
                          "Curacao",
                          "New Caledonia",
                          "Virgin Islands (U.S.)",
                          "Nauru",
                          "Palau",
                          "Somalia",
                          "Guinea-Bissau")))
       
```

```{r}
data_joined <- df_filter %>% 
    left_join(data_income, by = c("country_name" = "Economy",
                                "country_code" = "Code")) 
```

\section*{Mengyun}

```{r longdata-my, echo = FLASE}
# filter and pivot data to longer form
lit_long <- data_joined %>% 
  filter(str_detect(indicator, "Literacy")) %>% 
  filter(str_detect(indicator, "total")) %>% 
  pivot_longer(cols = c("2000":"2019"),
               names_to = "year",
               values_to = "rate")

# remove strings in indicator variable
lit_long$indicator <- lit_long$indicator %>% 
  substring(16) %>%
  str_remove("\\(") %>% 
  str_remove("\\)") %>% 
  str_remove("\\%") %>% 
  str_remove("total  of people ")
```

```{r world-my, fig.cap = "Global Literacy Rate for Adult and Youth between 2000-2019", echo = FALSE, message = FALSE}
lit_long %>% 
  filter(country_name == "World") %>% 
  ggplot(aes(x = year,
             y = rate,
             fill = indicator)) +
  geom_col(position = "dodge", width = 0.7) +
  theme_light() +
  ylim(0, 100) +
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=0.5)) +
  scale_fill_brewer(palette = "Paired") +
  labs(x = "Year",
       y = "Literacy Rate",
       fill = "Age") +
  ggtitle("Global Literacy Rate for Adult and Youth between 2000-2019")
  
```

Figure \@ref(fig:world-my) shows that although the literacy rate for adult aged 15 and above is lower that the literacy rate for youth aged 15-24 in each year, both rates are showing a slow and steady increase over the years. The improvements in the expansion of basic education and the reduction of education inequalities have contributed to an increase in the global literacy rate, over the last 65 years it increased by 4% every 5 years (Roser and Ortiz-Ospina, 2016)

https://ourworldindata.org/literacy#citation

@article{owidliteracy,
    author = {Max Roser and Esteban Ortiz-Ospina},
    title = {Literacy},
    journal = {Our World in Data},
    year = {2016},
    note = {https://ourworldindata.org/literacy}
}


```{r regions-my, fig.cap = "Global Literacy Rate for Adult and Youth between 2000-2019", echo = FALSE, warning = FALSE}
lit_long %>% 
  filter(country_name %in% c("Central Europe and the Baltics",
                             "East Asia & Pacific",
                             "Europe & Central Asia",
                             "Latin America & Caribbean",
                             "Middle East & North Africa",
                             "South Asia",
                             "Sub-Saharan Africa")) %>% 
  group_by(indicator) %>% 
  ggplot(aes(x = year,
             y = rate,
             group = country_name,
             color = country_name)) +
  geom_line() +
  facet_wrap(~indicator) +
  theme_light() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5)) +
  scale_colour_brewer(palette = "Paired") +
  labs(x = "Year",
       y = "Literacy Rate",
       color = "Regions") +
  ggtitle("Literacy Rate for Adult and Youth in Differenet Regions")
```

As the figure \@ref(fig:regions-my) shown above, there was a significant increase in the literacy rate in adult aged 15 and above in Middle East & North Africa, South Asia and Sub-Saharan Africa. South Asia and Sub-Saharan Africa also had improved the literacy rate tremendously in the youth age group over the years. Both East Asia & Pacific and Latin America & Caribbean had an 5% increase in literacy rate in the adult group where as the literacy rate increase approximately 4% in the youth group in Latin America & Caribbean and a small increase in the youth group in East Asia & Pacific. Regions like Central Europe and the Baltics and Europe & Central Asia had maintained a high literacy rate in both age groups over the years. Developed countries have better education facilities and system than developing countries, they tend to have higher literacy rate over the years.




```{r income-my, fig.cap = "Literacy Rate for Adult and Youth in Differenet Income Groups", echo = FALS}
lit_long %>% 
  filter(country_name %in% c("Low income",
                             "Lower middle income",
                             "Middle income",
                             "Upper middle income")) %>% 
  ggplot(aes(x = rate,
             y = year,
             fill = indicator)) +
  geom_col(position = "dodge") +
  facet_wrap(~country_name, 
             ncol = 4,
             labeller = label_wrap_gen(width = 18)) +
  theme_light() +
  scale_fill_brewer(palette = "Paired") +
  labs(x = "Literacy Rate",
       y = "Year",
       color = "Age") +
  ggtitle("Literacy Rate for Adult and Youth in Differenet Income Groups")
```

Figure \@ref(fig:income-my) demonstrates that both adult and youth groups that have higher income tend to have higher literacy rate








\section*{Zoljargal}


\section*{Xinrui}


\section*{Xueqi}


\section*{Conclusion}


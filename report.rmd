---
title: " "
author:
- familyname: YANG
  othernames: Mengyuan
  address: Monash University
  email: "myan0065@student.monash.edu"
  correspondingauthor: true
  qualifications:  Master of Business Analytics
- familyname: BATSAIKHAN
  othernames: Zoljargal
  address: Monash University
  email: "zbat0001@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: WANG
  othernames: Xinrui
  address: Monash University
  email: "xwan0274@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
- familyname: GOH
  othernames: Xueqi
  address: MONASH UNIVERSITY
  email: "xgoh0002@student.monash.edu"
  correspondingauthor: true
  qualifications: Master of Business Analytics
department: Our consultancy \newline Mengyuan YANG &\newline Zoljargal BATSAIKHAN &\newline Xinrui WANG &\newline Xueqi GOH
organization: Monash University
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
library(ggplot2)
library(gridExtra)
library(tinytex)
library(readxl)
library(naniar)
```


\section*{Introduction}

```{r}
excel_sheets("data/API_4_DS2_en_excel_v2_2252569.xls")

data_income <- read_excel("data/CLASS.xls", range = anchored("C5", dim = c(220,5))) %>% 
  select(-X) %>% 
  filter(Economy != "x")
```

```{r}
df<- read_excel("Data/API_4_DS2_en_excel_v2_2252569.xls", sheet = 1, range = "A4:BM42772") %>% 
  select("Country Name", 
         "Country Code",
         "Indicator Name", 
         "2000":"2019") %>% 
  rename("country_name" = "Country Name",
         "indicator" = "Indicator Name",
         "country_code" = "Country Code")
```


```{r}
df %>%
  group_by(country_name) %>%
  miss_var_summary() %>% 
  arrange(-pct_miss)
```

```{r}
df_filter <- df %>% 
  filter(!(country_name %in% c("Faroe Islands",
                          "Greenland",
                          "Isle of Man",
                          "Not classified",
                          "St. Martin (French part)",
                          "Northern Mariana Islands",
                          "Kosovo",
                          "American Samoa",
                          "Gibraltar",
                          "Sint Maarten (Dutch part)",
                          "Turks and Caicos Islands",
                          "Channel Islands",
                          "Guam",
                          "French Polynesia",
                          "Curacao",
                          "New Caledonia",
                          "Virgin Islands (U.S.)",
                          "Nauru",
                          "Palau",
                          "Somalia",
                          "Guinea-Bissau")))
       
```

```{r}
data_joined <- df_filter %>% 
    left_join(data_income, by = c("country_name" = "Economy",
                                "country_code" = "Code")) 
```

\section*{Mengyun}


\section*{Zoljargal}


\section*{Xinrui}

```{r}
df_outsch <- data_joined %>% 
  filter(indicator %in% c("Children out of school (% of primary school age)",
                          "Children out of school, male (% of male primary school age)",
                          "Children out of school, female (% of female primary school age)")) %>% 
  pivot_longer(cols = "2000":"2019",
               names_to = "year",
               values_to = "value") %>% 
  pivot_wider(id_cols = -indicator,
              names_from = indicator,
              values_from = value) %>% 
  rename("children_out_of_school_tot_%" = `Children out of school (% of primary school age)`,
         "children_out_of_school_m_%" = `Children out of school, male (% of male primary school age)`,
         "children_out_of_school_f_%" = `Children out of school, female (% of female primary school age)`)
```


```{r}
outsch <- df_outsch %>% 
  filter(country_name %in% c("East Asia & Pacific",
                             "Europe & Central Asia",
                             "Latin America & Caribbean",
                             "Middle East & North Africa",
                             "North America",
                             "South Asia",
                             "Sub-Saharan Africa")) 

```




\section*{Xueqi}


\section*{Conclusion}

